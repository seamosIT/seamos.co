<%= form_for(poll, html: { multipart: true } ) do |f| %>
<%= render 'shared/mensajes_de_error',  object: f.object %>

<div class="field">
    <%= f.label :title %>
    <%= f.text_field :title, class: 'form-control' %>
</div>

<div class="field description">
    <%= f.label :description %>
    <%= f.text_area :description, id: 'poll-description',class: 'form-control', maxlength: 500 %>
    <label id='counter-label' class='char-left'>500</label>
</div>

<div class="field" style="display:none">
    <%= f.text_field :tags, id: 'tags-field'%>
</div>

<div class="field">
    <%= f.label :closing_date %>
    <input type="text" value="<%= poll.closing_date %>" data-provide='datepicker' data-date-language="es" data-date-autoclose="true" data-date-format="yyyy/mm/dd" class="input-sm form-control" name="poll[closing_date]"/>
</div>

<div class="field">
    <%= f.label t('.poll_image') %>
    <% if poll.poll_image.file %>
    <p class="has_media">
        <%= t('.has_image', filename: poll.poll_image.file.filename) %>
    </p>
    <% end %>
    <%= f.file_field :poll_image %>
    <%= f.hidden_field :poll_image_cache %>
</div>

<div id='document_field' class="field">
    <%= f.label t('.document_field') %>
    <% if poll.poll_document.file %>
    <p class="has_media">
        <%= t('.has_document', filename: poll.poll_document.file.filename) %>
    </p>
    <% end %>
    <%= f.file_field :poll_document%>
</div>

<div class="tags-picker">
    <%= f.label t('.tags_picker') %><br>
    <div class="alert alert-info alert-dismissable">
        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
        Selecciona las etiquetas que más se adecúen a tu propuesta.
    </div>
    <%= render '/tags/tag_list', tags: Tag.all, location_from: "new_poll" %>
</div>

<div class="actions">
    <%= f.submit(data: {disable_with: I18n.t(:processing)}, class: "btn btn-primary") %>
</div>

<% end %>
<script type="text/javascript">
    function addOption() {
        var optionsContainer = $("#vote_types_attributes");
        var childrenCount = optionsContainer.children().length;
        // #ToDo add DELETE option && error takes previous values
        var myHTML = `<input type='text' placeholder='<%= t('.new_option')%>' name='poll[vote_types_attributes][${childrenCount}][name]' id='poll_vote_types_attributes_${childrenCount}_name'>`;

        optionsContainer.append(myHTML);
    }
</script>
